The attacks associated with the new botnet attempted to exploit the CVE-2017-17215 zero-day vulnerability in the Huawei home router caused by the fact that the TR-064 technical report standard, which was designed for local network configuration, was exposed to WAN through port 37215 (UPnP – Universal Plug and Play).
About 12 hours ago (2017-12-05 11:57 AM GMT+8), we noticed a new version of Satori (a mirai variant which we named Satori), starting to propagate very quickly on port 37215 and 52869.
Two new exploits, which work on port 37215 and 52869 have been added, see below for more details.
Due to the worm like behavior, we all should be on the lookout for the port 37215 and 52869 scan traffic.
For those who don’t have the visibility, feel free to check out our free Scanmon system for port 37215 and 52869, or ISC port pages for 37215 and 52869.
As can be seen from the following picture, the bot will scan port 37215 and 52869 randomly, determined by the remainder of a random integer mod 3.
During the scanning, Satori will utilize two different exploits, one on port 37215, while the other on 52869.
The one on port 37215 is not fully disclosed yet, our team has been tracking this in the last few days and got quite some insight, but we will not discuss it here right now.(stay tuned for our update later).
For example, during last recent 12 hours we have seen 263,250 different IPs scanning port 37215, and 19,403 IPs scanning port 52869.
We analyzed another Mirai variant called “Miori,” which is being spread through a Remote Code Execution (RCE) vulnerability in the PHP framework, ThinkPHP.
For its arrival method, the IoT botnet uses the said exploit that affects ThinkPHP versions prior to 5.0.23 and 5.1.31.
Our own analysis revealed that the cybercriminals behind Miori used the ThinkPHP RCE to make vulnerable machines download and execute their malware.
With Mirai Comes Miori: IoT Botnet Delivered via ThinkPHP Remote Code Execution Exploit.
Miori now spreading via Remote code execution vulnerability in
the PHP framework called ThinkPHP and the exploit for this vulnerability is completely new that affected ThinkPHP versions prior to 5.0.23 and 5.1.31.
Apart from this, several Mirai malware various are being distributed by exploiting the same ThinkPHP RCE vulnerability.
The Miori bot borrows the code from the dreaded Mirai malware and it first appeared in the threat landscape in late 2018 when the bot was spread by exploiting a ThinkPHP remote code execution vulnerability after the exploit code was made publicly available. 
Among the list of devices targeted by the Wicked Mirai are Netgear DGN1000 and DGN2200 v1 routers (also used by Reaper botnet).
Specifically, port 8080 brings an exploit for a flaw in Netgear DGN1000 and DGN2200 v1 routers (also used by the Reaper botnet).
On port 8080, the malware uses Netgear DGN1000 and DGN2200 v1 router exploits (also used by Reaper botnet).
If connected to Port 8080, the malware will use a remote code execution (RCE) Netgear exploit which works on DGN1000 and DGN2200 v1 routers, and is the same tool used by the Reaper botnet to compromise target machines.
On port 8080, Netgear DGN1000 and DGN2200 v1 router exploits are used, a CCTV-DVR remote code execution exploit is used on port 81, 
Below is a list of devices targeted by the Wicked Mirai; Port 8080: Netgear DGN1000 and DGN2200 v1 routers.
Devices Targeted by Wicked include Netgear DGN1000 and DGN2200 v1 routers on Port 8080.
When connected to Port 8080, the malware uses a remote code execution (RCE) Netgear exploit which works on DGN1000 and DGN2200 v1 routers.
Emotet has used ports 20, 22, 80, 443, 8080, and 8443.
The dissection of this suspicious file, known by Symantec as Trojan.Emotet, shows common elements such as: TCP communication over ports 80, 8080, 22,990.
Emotet connects to C2 servers on various ports including, but not limited to: 20, 80, 443, 7080, 8443, and 50000
We can see that port 80 returns the same universal 404 error as the hacked server did on the Emotet port, so most likely this is the port it forwards traffic to.
The C2 servers can receive these communications on port 80, which is the default port for HTTP, but may also receive them on port 443, which is the default for HTTPS traffic, or on a number of other nonstandard ports, including but not limited to 7080, 8080, 8090, 50000, or several others. 
The initial executable appears to launch an application application lpiograd.exe, seen in Figure 2 and then looks to make outbound network connections on port 80, to a single command and control (CnC) server
Emotet Trojan used commonly used port for communication (e.g TCP port 80, 8080, 443, 8443, 7080, 20, 22, 53)
5.101.138.188 port 80 - sloegincottage.co.uk - GET /tyoinvur/En_us/Clients/092018/
108.167.161.63 port 80 - louisianaplating.com - GET /18Ge0wDF
50.62.194.30 port 80 - c-t.com.au - GET /PspAMbuSd2
37.120.175.15 port 80 - Attempted TCP connections, no response from the server
Based on our visibility over the last 30 days, 14 IPs communicated with 5.45.65[.]126 on port 80/TCP, 13 of which were validated Tier 1 C2s. 
Traffic observed to 212.8.242[.]201 was similar, with 23 IPs communicating on port 80/TCP, 22 of which were validated Tier 1 C2s.
One technique is by simply swapping a .doc file with a .docx, which can make static detection of maldocs more difficult due to the compression native in the .docx format. 
While the attached documents all have a .doc extension, they are in fact .dotm, .docx, and other document file types, which enables them to successfully hide the embedded objects as ActiveX objects rather than typical “Form” objects whose metadata can be easily accessed in an opened document.
[F00000000][T01D19C127D907AA0][O00000000]*%USERPROFILE%\Desktop\New Microsoft Word Document.docx
However, the document in this case is not the usual .doc or .docx but rather an XML file masquerading as a .doc, and the macro in this instance makes use of the Shapes feature,
Cybercriminals are attaching .pdf, .mp4, and .docx files to emails that purport to have information on how people can protect themselves from the virus, updates on its spread and even virus detection procedures. 
The Emotet malware will disguise itself as a website hyperlink or regular file attachment in an email (.doc, .docx, .PDF), that will include hidden code that enables cybercriminals to gain control of your computer and other devices, often leading to the deployment of ransomware.
Known as Emotet, the trojan is attached under the guise of pdf, mp4 and docx files.
Emotet is most commonly spread via malicious emails containing Microsoft Office attachments, usually Microsoft Word (.doc, .docx) documents.
Microsoft will also force a different file extension (.docm instead of .docx for new documents containing macros).
It is most commonly spread via Microsoft Office attachments, usually Microsoft Word (.doc, .docx) documents.
In HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.docx\OpenWithProgids
Also, security experts at Kaspersky identified this malware spreading in form of pdf, mp4 and Docx files.
According to security firm Kaspersky, attackers are using several types of malicious files, including pdf, mp4 and docx with “coronavirus” theme to spread malware.
In particular, the registry key HKLM\Software\Clients\Mail\Microsoft Outlook is accessed, and the value DllPathEx—the path to the mapi32.dll module—is expected to be defined.
Old Emotet malware checks the configuration module of the email client especially the registry key HKLM\Software\Clients\Mail\Microsoft Outlookto exfiltrate the Email data.
The first step to check if it is infected is to look at the configuration - the path to the DllPathEx-mapi32.dll module, especially the HKLM\Software\Clients\Mail\Microsoft Outlook access registry key. 
When this module is executed, it checks for the presence of registry key HKLM\Software\Clients\Mail\Microsoft
Outlook and then checks value of DLLPathEx i.e. the path to the mapi32.dll module. 
Provides information about used mail client (read from “HKLM\Software\Clients\Mail” registry key value) and if it’s Microsoft Outlook and it’s MAPI DLL is 64-bit, name is followed by ” x64″ suffix.
Emotet's module when executed checks for the presence registry key HKLM\Software\Clients\Mail\Microsoft Outlook and accesses, expecting the DllPathEx value to be defined.
PPTP uses TCP 1723 to set up the connection, but uses GRE (protocol 47) for the user traffic
Zeus’ main vectors are mail spam, malicious social engineering and by inserting itself into legitimate product downloads, also known as drive-by downloads.
The new Emotet "WiFi spreader" module (as it was called) does not guarantee an 100% infection rate, as it relies on users utilizing weak passwords for their WiFi networks, however, it opens a new attack vector inside infected companies that the Emotet gang can exploit to maximize their reach.
Mirai botnet variants include Satori, Okiru, Masuta, PureMasuta, OMG, IoTroop, Wicked, JenX, Fbot, Torii, Miori, and Yowai.
Mirai variant Masuata and its sub-variant PureMasuta leverages SOAP exploit to persuade targeted devices to run commands issued by the attacker.
OMG turns infected devices into proxy servers and provides a network of proxy servers for rent to several cybercriminals who are looking for DDoS generators, a SPAM network, crypto-jacker scheme, or ransomware empire.
These ports can be opened and used by software application and operating system services under certain protocols (e.g. TCP, UDP) across the network (LAN or WAN) to send and receive information.
Analyzing the general distribution of the compromised domains, grouped by category, it is possible to verify that the most affected were as follows: professional/companies (20.2%), personal (13.5%), retail (12.7%) and industry (11.9%).
In this case the infected host 192.168.1.100 (which is the Windows XP machine where the sample was run) is sending the encrypted traffic to C2 (192.168.1.2 which is my Linux machine acting as C2) on port 2011, also in this case the magic keyword “Gh0st” was sent in the first 5 bytes
This is followed by SSL/TLS traffic over ports 447 and/or 449.Depending on the type of traffic it will either connect to TCP447, TCP449 or TCP8082 mixed with traffic over normal HTTP/HTTPS ports.
Using the port 53281 as filter to our NetFlow, it became obvious that inbound traffic towards the C2 could be placed into two categories, anonymous proxy and infected traffic
Traffic over ports 443 and 449 to the IPs in the IOC section are an atomic indication of Trickbot [6], worthy of tracking and identifying hosts for investigation.
Monitoring and logging PowerShell events on Windows is good practice and works best with endpoints having PowerShell 5.0 installed. Both Script Blocks logging and Module logging are the auditing options to set. See PowerShell Auditing in the appendix
While it’s difficult for AV to trace polymorphic packed malware, IDS solutions such as Bro/Zeek now include integration with JA3 for SSL string hashes to match Trickbot traffic
The password grabber and some other TrickBot modules send stolen data using unencrypted HTTP over TCP port 8082 to an IP address used by TrickBot
PoisonIvy opens a backdoor on TCP ports 6868 and 7777.
A TYPEFRAME variant can use port 127 for communications.
The Emotet payload was delivered onto the targets' computers using malicious emails which come with zipped up Powload Trojan attachments which will download the Emotet executable after being launched.
Before this was implemented, Emotet would use "an HTTP GET request to send victim information to the C&C server, and the data is stored in the Cookie header.
There is a total of 65,535 TCP ports and another 65,535 UDP ports; we’ll look at some of the diciest ones.
Oddly enough, Emotet does communicate over ports such as 22, 8080 and 443 where unencrypted HTTP transmissions are not common and yet still often evades detection.The Walt Disney Company announced this afternoon that Robert Iger, the company’s long-time CEO who ushered in the company’s lush franchise and entertainment platform profits, will step down immediately as chief executive.
Bob Chapek, a long-time senior exec at the company who most recently held the position of chairman of Disney Parks, Experiences and Products, will succeed him.
Update: We’ve added Iger’s company-wide email to employees (below).
Chapek, as head of Disney’s Parks Division, was a somewhat divisive figure in that he led with a “value engineering” (the Imagineering word for trimming cool stuff) and budget conscious strategy instead of the more popular “let Imagineers do the most” tactic that has produced some of the parks’ most enduring rides and experiences.
Disney Twitter has been quick to descend upon the Chapek choice as a sign of possible rough times ahead for Parks budgets.
Our guess for who would head Parks is Josh D’Amaro, extremely-well liked former head of Disneyland who now heads Walt Disney World — liked by Parks people for a lot of the opposite reasons, which politically could make this a non starter, but would be a very popular appointment.
A few oddities surround this sudden change.
Iger is only 14 months into a 36-month contract extension, and this comes not on a regularly scheduled earnings call but in the midst of an interesting time for Disney, as it faces parks shutdowns due to the coronavirus outbreak.
Disney’s earnings have been amazing lately, which would have made for a nice two-hander at earnings time.
Speculation is still high for the exact reason behind Iger’s departure, with many hoping for something benign (ish) like a presidential run versus a personal issue.
Iger will address Disney employees at 5:30EST today, and we’ll update if anything further comes of that address.
Under Iger’s tenure since 2005, Disney expanded aggressively into movies, theme parks and other entertainment verticals, culminating late last year with the introduction of the company’s Disney+ streaming service and $71.3 billion acquisition of 21st Century Fox, a gargantuan television and movie studio.
Iger oversaw such dramatic acquisitions as Marvel Entertainment  a little more than a decade ago, and also bought Lucasfilm and its Star Wars and Indiana Jones series.
He also helped to rebuild a partnership with late Apple founder and CEO Steve Jobs, and eventually acquired the Pixar animation studio, which Jobs had founded in 1986.
Those decisions, among other aggressive media growth strategies, have given Disney a commanding role in the media universe.
As Jake Coyle noted in the AP earlier this year:  But in today’s IP-driven movie world, one studio is in a league of its own.
In 2019, Disney dominated American moviegoing more than any studio ever has before — roughly 38% of all domestic moviegoing.
The year’s top five films were all Disney movies, and it played a hand in the sixth.
Disney’s Marvel Studios produced the Sony Pictures release “Spider-Man: Far From Home.”  Since its launch, Disney+ itself has drawn almost 30 million subscribers, according to data released by the company earlier this month.
Disney+ already has 28.6M subscribers  Iger will assume the role of executive chairman through 2021 according to Disney’s statement.
It has been no secret that Iger has been thinking about succession planning for years, but at least until recently, details had remained scant.
Media analysts probed for news in Iger’s book “The Ride of a Lifetime,” which was published late last year and was a summation of his tenure at the media conglomerate and his business philosophy.
Yet, finding a successor at the company has been challenging, with multiple heirs apparent departing the company when the top slot looked like it would remain locked in Iger’s grasp.
Disney to “broaden the scope” of succession planning as its COO departs  On an already heavy red-ink day, Disney stock was further hit in after-hours trading by investors.
Yahoo Finance’s most recent quotes puts Disney stock down 2.57% in after-hours trading, following a 3.62% decline during trading hours stemming from the global coronavirus outbreak.
Disney has significant properties in Asia, including Shanghai Disney Resort, which was the company’s first platform in China and was overseen by incoming CEO Chapek.
Update: Here’s Bob Iger’s letter to Disney employees.
Dear Fellow Employee, Today the Board of Directors announced that Bob Chapek  has been named Chief Executive Officer of The Walt Disney Company, effective immediately.
I have assumed the role of Executive Chairman and will continue to direct the Company’s creative endeavors, while also leading the Board.
This is an exciting day for our company, an historic day—and I’m thrilled for Bob.
I’ve worked closely with him for many years and have absolute confidence in his abilities, as does the Board.
As CEO, Bob will oversee all of the Company’s business segments and corporate functions, and we will work closely together through the end of 2021 to further the Company’s strategic objectives and to ensure a smooth and successful transition.
Bob has been with Disney for nearly three decades, and during this time he has achieved stellar results across a wide array of businesses.
Throughout he’s led with integrity and conviction, always respecting Disney’s rich legacy, while at the same time taking smart, innovative risks for the future.
As president of Home Entertainment for the Studio, he spearheaded the highly successful “vault strategy” that brought Disney’s iconic films and characters to new generations of viewers.
As president of distribution for the Studio, he directed the Company’s film distribution strategy and expanded our global reach across multiple platforms.
As head of Consumer Products, he transformed the business, focusing it on our key franchises and embracing technological innovation to deliver unmatched consumer experiences.
Most recently, as Chairman of Parks, Experiences and Products, he oversaw the largest capital expansion in the history of our parks that included the opening of Shanghai Disney Resort, a doubling of the Disney Cruise Line fleet, and the creation of the new Star Wars: Galaxy’s Edge lands at Disneyland and Walt Disney World.
Bob has worked closely and collaboratively with leaders across the different segments of our company, and I’m confident he will apply the same vision, passion and commitment to excellence in his new role as Chief Executive Officer.
I’ve had the tremendous privilege of being CEO for the past 15 years, and it’s been thrilling for me to be part of such an exciting and productive era for our company.
I’m enormously proud of all that we’ve accomplished, creatively, financially and strategically—including the acquisition of Twenty-First Century Fox and the incredibly successful launch of our direct-to-consumer businesses.
With these key endeavors well underway, I believe it’s the right time to transition to a new CEO and I believe Bob is absolutely the right person to assume this role and lead our company in this next pivotal period.
I am certain that under his leadership, our portfolio of great businesses and our amazing and talented people will continue to serve our company and our shareholders well into the future.
I congratulate Bob and look forward to working with him in his new role as CEO, along with the other members of our amazing leadership team.
Bob and I will hold a town hall meeting tomorrow in the Main Theatre at 9 a.m. PT.
To RSVP for the theater or to view the live webcast, please click here.
My thanks and best to you all, Bob Matthew Panzarino contributed additional details about Chapek and context around Disney’s succession.
